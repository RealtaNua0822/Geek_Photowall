<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebPåŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .image-test {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #333;
            border-radius: 8px;
        }
        .image-comparison {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .image-item {
            text-align: center;
        }
        .image-item img {
            max-width: 300px;
            height: auto;
            border: 2px solid #444;
            border-radius: 4px;
        }
        .image-item h4 {
            margin: 10px 0 5px;
            color: #4CAF50;
        }
        .file-size {
            font-size: 12px;
            color: #888;
        }
        .webp-badge {
            background: linear-gradient(45deg, #4285f4, #34a853);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .webp-info {
            color: #34a853;
            font-weight: bold;
            font-size: 14px;
            text-shadow: 0 0 5px rgba(52, 168, 83, 0.3);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª WebPåŠŸèƒ½æµ‹è¯•é¡µé¢</h1>
        
        <div class="image-test">
            <h3>å›¾ç‰‡æ ¼å¼å¯¹æ¯”æµ‹è¯•</h3>
            <div class="image-comparison">
                <div class="image-item">
                    <h4>åŸå§‹å›¾ç‰‡ <span class="webp-badge">åŸå›¾</span></h4>
                    <img src="/uploads/photos/1766401520163-991834129.jpg" alt="åŸå§‹å›¾ç‰‡" loading="lazy">
                    <p class="file-size">å¤§å°: ~759KB</p>
                </div>
                
                <div class="image-item">
                    <h4>ä¸­ç­‰å°ºå¯¸å›¾ç‰‡ <span class="webp-badge">å‹ç¼©</span></h4>
                    <img src="/uploads/photos/medium_1766401520163-991834129.jpg" alt="ä¸­ç­‰å°ºå¯¸å›¾ç‰‡" loading="lazy">
                    <p class="file-size">å¤§å°: ~133KB</p>
                </div>
                
                <div class="image-item">
                    <h4>WebPæ ¼å¼ <span class="webp-badge">WebP</span></h4>
                    <picture>
                        <source srcset="/uploads/webp/1766401520163-991834129.webp" type="image/webp">
                        <source srcset="/uploads/photos/medium_1766401520163-991834129.jpg" type="image/jpeg">
                        <img src="/uploads/photos/1766401520163-991834129.jpg" alt="WebPå›¾ç‰‡" loading="lazy">
                    </picture>
                    <p class="file-size">å¤§å°: ~84KB</p>
                    <p class="webp-info">âœ… WebPä¼˜åŒ–ç‰ˆæœ¬å¯ç”¨</p>
                </div>
            </div>
        </div>

        <div class="image-test">
            <h3>ç°ä»£æµè§ˆå™¨Pictureæ ‡ç­¾æµ‹è¯•</h3>
            <p>ä¸‹é¢çš„å›¾ç‰‡ä½¿ç”¨äº†HTML5çš„&lt;picture&gt;æ ‡ç­¾ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ ¼å¼ï¼š</p>
            <div class="image-item">
                <picture>
                    <source srcset="/uploads/webp/1766402447407-618750776.webp" type="image/webp">
                    <source srcset="/uploads/photos/medium_1766402447407-618750776.jpg" type="image/jpeg">
                    <img src="/uploads/photos/1766402447407-618750776.jpg" alt="Pictureæ ‡ç­¾æµ‹è¯•" loading="lazy" style="max-width: 500px;">
                </picture>
                <p class="webp-info">ğŸš€ å¦‚æœæµè§ˆå™¨æ”¯æŒWebPï¼Œä¼šè‡ªåŠ¨åŠ è½½WebPç‰ˆæœ¬</p>
            </div>
        </div>

        <div class="image-test">
            <h3>APIå“åº”æµ‹è¯•</h3>
            <button onclick="testAPI()">æµ‹è¯•ç…§ç‰‡API</button>
            <div id="api-result"></div>
        </div>
    </div>

    <script>
        async function testAPI() {
            try {
                const response = await fetch('/api/photos');
                const photos = await response.json();
                
                const resultDiv = document.getElementById('api-result');
                const firstPhoto = photos.find(p => p.webpPath);
                
                if (firstPhoto) {
                    resultDiv.innerHTML = `
                        <h4>âœ… APIæµ‹è¯•æˆåŠŸ</h4>
                        <p><strong>ç…§ç‰‡ID:</strong> ${firstPhoto.id}</p>
                        <p><strong>åŸå›¾è·¯å¾„:</strong> ${firstPhoto.path}</p>
                        <p><strong>ä¸­ç­‰å°ºå¯¸:</strong> ${firstPhoto.mediumPath || 'æœªç”Ÿæˆ'}</p>
                        <p><strong>WebPè·¯å¾„:</strong> ${firstPhoto.webpPath || 'æœªç”Ÿæˆ'}</p>
                        <p><strong>ç¼©ç•¥å›¾:</strong> ${firstPhoto.thumbnailPath}</p>
                        <p><strong>å°ºå¯¸:</strong> ${firstPhoto.width} Ã— ${firstPhoto.height}</p>
                        <p><strong>æ–‡ä»¶å¤§å°:</strong> ${(firstPhoto.size / 1024).toFixed(1)}KB</p>
                        <p class="webp-info">${firstPhoto.webpPath ? 'âœ… WebPä¼˜åŒ–å¯ç”¨' : 'âŒ WebPæœªç”Ÿæˆ'}</p>
                    `;
                } else {
                    resultDiv.innerHTML = '<p class="webp-info">âŒ æœªæ‰¾åˆ°åŒ…å«WebPçš„ç…§ç‰‡</p>';
                }
            } catch (error) {
                document.getElementById('api-result').innerHTML = `<p>âŒ APIæµ‹è¯•å¤±è´¥: ${error.message}</p>`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•
        window.onload = function() {
            console.log('ğŸ§ª WebPæµ‹è¯•é¡µé¢å·²åŠ è½½');
            testAPI();
        };
    </script>
</body>
</html>